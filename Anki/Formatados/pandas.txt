001) Como renomear uma ou mais colunas de um dataframe no pandas?	df = df.rename(columns={'A': 'Coluna1', 'B': 'Coluna2'}) <br><br> df.columns = ['Coluna1', 'Coluna2']
002) Como alterar a ordem das colunas em um dataframe do pandas?	new_order = ['B', 'A', 'C'] <br> df = df[new_order]
003) Como obter uma lista dos nomes das colunas de um dataframe no pandas?	list(df.columns)
004) Como obter uma lista com os índices de um dataframe no pandas?	list(df.index)
005) Como obter uma lista com os nomes das colunas que sejam de um mais tipos no dataframe do pandas?	df.select_dtypes(include = 'int').columns <br><br> df.select_dtypes(include = ['float', 'int']).columns
006) Como acessar uma célula específica de um dataframe com base em seu índice e coluna (pegar seu valor e também poder alterar o valor)?	df.at[índice, coluna]
007) Como criar um dataframe do zero?	Defina um dicionário onde as chaves serão o nome das colunas colunas e os valores serão as linhas, a quantidade de valores (linhas) precisam ter o mesmo tamanho. <br><br> df = pd.DataFrame(dados)
008) Como salvar um dataframe no formato csv, excel ou parquet?	df.to_excel(excel_writer = 'arquivo_excel.xlsx', sheet_name= "Nome da aba", index = False) <br> df.to_csv(path_or_buf = "arquivo_csv.csv", sep = ";", index = False) <br> df.to_parquet(path = "arquivo.parquet", engine = "pyarrow", index = False)
009) Como instalar as bibliotecas do parquet para usar os dataframes do pandas?	pip install pandas pyarrow <br> pip install fastparquet
010) Como pegar o índice e transformar em uma coluna, por exemplo, um índice de datas?	df.reset_index(inplace = True) <br> df.rename(columns={'index': 'Date'}, inplace=True) <br><br> 1) Reseta o índice do dataframe porém não dropa esse índice, isso faz com que uma nova coluna seja criada <br> 2) Depois é só renomear essa nova coluna índice para o nome que você desejar
011) Como resetar o índice em um dataframe?	df.reset_index(inplace = True, drop = True)
012) Como deletar uma ou mais colunas de um dataframe?	df.drop(columns = ['A', 'C'], inplace = True) <br><br> del df['B'] <br><br> coluna_A = df.pop('A') <br> df = df.loc[:, df.columns != 'a']
013) Como apresenta a quantidade de classes em uma coluna e suas respectivas quantidades?	df['coluna'].value_counts()
014) Como criar um dataframe com base na filtragem de linhas de uma colunas em relação à uma lista?	novo_df = df[df['coluna_1'].isin(values = lista)]
015) Como apresentar a soma e a média dos valores nulos das colunas de um dataframe?	df.isnull().sum() <br> df.isna().sum() <br><br> df.isnull().mean() <br> df.isna().mean()
016) Como apresentar a soma e a média dos valores não nulos das colunas de um dataframe?	df.notna().sum() <br> df.notnull().sum() <br><br> df.notna().mean() <br> df.notnull().mean()
017) Como apresentar as primeiras linhas de um dataframe, as últimas e linhas aleatórias?	df.head() <br> Por padrão apresenta as 5 primeiras linhas <br><br> df.tail() <br> Por padrão apresenta as 5 últimas linhas <br><br> df.sample() Por padrão apresenta 1 linha aleatória
018) Como apresentar dados básicos de um dataframe como, quantidade, média, desvio padrão, valor mínimo e máximo, quartil de 25, 50 e 75%?	df.describe()
019) Como apresentar os dados do dataframe referentes ao tipo de cada coluna, aos valores não nulos e a quantidade de memória utilizada?	df.info()
020) Como mostrar a quantidade de linhas de cada coluna em um dataframe?	df.count()
021) Como criar um novo dataframe, considerando algumas colunas de outro dataframe?	df = df_antigo[[coluna_1, colunas_2]]
022) Como alterar o nome da coluna índice de um dataframe?	df.index.name = "Data"
023) Como remover o nome da coluna índice de um dataframe?	df.index.name = None
024) Como transformar um arquivo do formato series para o formato dataframe?	.to_frame()
025) Como criar um dataframe através de uma lista de tuplas?	colunas = ['coluna_1', 'coluna_2'] <br> df_rotacoes = pd.DataFrame(data = lista_de_tuplas, columns = colunas)
026) Como criar uma lista de tipos de colunas de um dataframe seguindo a sequência?	list(df.dtypes)
027) Como obter informações báiscas e iniciais das colunas não-numéricas de um dataframe, como seus valores únicos, a frequência?	df.describe(exclude = "number")
028) Como pegar somente uma coluna de um dataframe e deixá-la também em dataframe ao invés de series?	df_coluna_1 = df[["coluna_1"]]
029) Como visualizar o describe de um dataframe do pandas com os números com menos casas decimais?	with pd.option_context("float_format", "{:.1f}".format): <br> display(df_cereal.describe())
030) Com base em um dataframe do pandas, como faço para verificar a soma e a média de linhas de todas as colunas que satisfazem uma determinada condição?	((df_cereal.select_dtypes(include="number") == 100) | (df_cereal.select_dtypes(include="number") == 50)).mean() * 100 <br><br> ((df_cereal.select_dtypes(include="number") < 100) & (df_cereal.select_dtypes(include="number") > 50)).mean() * 100 <br><br> df_cereal[df_cereal.isin([100, 50])].count()
031) Como mostrar a quantidade de valores únicos para cada coluna de um dataframe no pandas?	df.nunique()
032) Como mostrar quais são os valores únicos para uma determinada coluna de um dataframe no pandas?	df["coluna_1"].unique()
033) Como selecionar uma faixa de linhas e colunas para um dataframe no pandas?	df.iloc[3:7, 1:4] <br><br> df[3:7] # Seleciona somente as linhas
034) Como selecionar linhas e colunas específicas de um dataframe no pandas com base em seu índice numérico?	df.iloc[[1, 4, 7], [2, 5]]
035) Como selecionar linhas e colunas específicas de um dataframe no pandas com base em seus nomes?	df.loc[[1, 4, 7], ["coluna_1", "coluna_2"]]
036) Quais são os operadores lógicos de um dataframe no pandas (que também são utilizados no numpy)?	& # and <br> | # or <br> ~ # not
037) Como obter o valor máximo e o valor mínimo de cada coluna de um dataframe do pandas?	df.max(numeric_only = True) <br> df.min(numeric_only = True)
038) Como obter os índices das linhas que possuem o valor máximo e o valor mínimo para cada coluna de um dataframe do pandas?	df.idxmax() <br> df.idxmin()
039) Como usar o query no pandas?	df.query("coluna_1 > 100 and coluna_2 < 50") <br> df.query("coluna_1 > 100 or not coluna_2 < 50") <br> df.query("coluna_3 == 'classe_a' and coluna_4 != 'classe_b'")
040) Como usar o groupby no pandas?	df.groupby(["coluna_1", "coluna_2"])[["coluna_3", "coluna_4", "coluna_5"]].mean()
041) Como ordenar um dataframe com base em uma coluna numérica?	df.sort_values(by = ["coluna_1", "coluna_2"], ascending = False) <br><br> ascending = True (Padrão)
042) Como dividir uma coluna numérica de um dataframe em x faixas iguais e observar a quantidade ou a frequência de cada faixa?	df["coluna_1"].value_counts(bins = 5, normalize = False) <br><br> normalize = False (padrão) <br> Mostra a quantidade normalize = True, Mostra o percentual
043) Qual o método do pandas para ordenar uma dataframe ou series de acordo com o índice?	.sort_index(ascending = True)
044) Como arredondar as casas decimais de todas as colunas numéricas de um dataframe?	df.round(decimals = 2)
045) Como transformar um dataframe em um dicionário?	dicionario = df.to_dict(orient = "list")
046) Explique o conceito de pivot no dataframe do pandas?	df.pivot(index = ["coluna_1", "coluna_2"], columns = ["coluna_3", "coluna_4"], values = "coluna_5") <br><br> É um método que altera a estrutura do dataframe, de modo que realiza agrupamentos tanto nos índices quanto nas colunas. Só vai funcionar caso não haja duplicatas.
047) Explique o conceito de stack e unstack no dataframe do pandas?	# Transforma colunas padrão para colunas índices <br> df_pivot.stack(level = [0, 1], future_stack = True) <br><br> # Para transformar colunas de índice em colunas padrão <br> df_pivot_stack.unstack(level = [1, 2])
048) Explique o conceito de pivot_table no dataframe do pandas?	df.pivot_table(index = ["Estudante", "Categoria"], columns = ["Semana", "Tópico"], values = "Nota", aggfunc = ["mean", "size"], margins = True, margins_name = "Total") <br><br> # É semelhante ao método pivot, contudo esse método realiza alguma operação com as linhas duplicadas, como a média, soma, contagem
049) Qual é a outra função de agregação do pandas utilizado junto com o groupby para saber a quantidade?	df.groupby(by = ["coluna_1", "coluna_2"]).size()
050) É possível utilizar o método plot() em um dataframe ou series do pandas para gerar um gráfico rápido, explique quais são os tipos de gráficos que podem ser gerados?	bar <br> barh <br> hist # Você pode passar um parâmetro chamado 'bins' <br> kde = density <br> box <br> scatter # Você passar o nome da coluna no x e no y <br> hexbin # Você passar o nome da coluna no x e no y <br> line <br> pie # Você pode passar autopct='%1.1f%% <br> area
051) Como remover linhas de um dataframe que contenha pelo menos um valor nulo?	df.dropna(axis = 0, how = "any", inplace = True) <br> df.dropna(axis = 0, how = "all", subset = ["coluna_1", "coluna_2"], inplace = True)
052) Como obter as linhas de um dataframe que são duplicadas?	df.duplicated()
053) Como saber a quantidade total e a média das linhas duplicadas de um dataframe?	df.duplicated().sum() <br> df.duplicated().mean()
054) Como obter um dataframe com apenas as linhas duplicadas?	df[df.duplicated()]
055) Como obter um dataframe sem as linhas duplicadas?	df[~df.duplicated()] <br> df.drop_duplicates(keep = 'first', inplace = True) # Por padrão, quando as linhas duplicadas são removidas, é mantida a primeira ocorrência <br> df.drop_duplicates(keep='last', inplace = True) # Você também pode manter somente a última ocorrência <br> df.drop_duplicates(keep = False, inplace = True) # Você pode remover todas as linhas que são duplicadas
056) Como remover as linhas duplicadas considerando uma ou mais colunas específicas de um dataframe?	df.drop_duplicates(subset = ['coluna_1', 'coluna_2'])
057) Como transformar uma ou mais colunas de um dataframe do pandas para um array do numpy?	df[["coluna_1", "coluna_2"]].values <br> df[["coluna_1", "coluna_2"]].to_numpy()
058) Como transformar uma coluna de um dataframe para o índice?	df.set_index(keys = "coluna_x", inplace = True)
059) Como fazer com que as linhas de uma ou mais colunas de um dataframe do pandas sejam deslocadas para frente ou para trás?	df[["coluna_1", "coluna_2"]].shift(periods = 1)
060) Como alterar o tipo de uma determinada coluna de um dataframe?	df['coluna_1'] = df['coluna_1'].astype(dtype = np.int32)
061) Como alterar a posição de uma coluna específica de um dataframe para uma posição particular?	column_to_move = df.pop('coluna_1') <br> df.insert(loc = 3, column = 'cidade', value = column_to_move)
062) Como criar uma nova coluna em um dataframe com base em uma lista garantindo que não haja erros de ambiguidade do dataframe original e de suas fatias?	df.loc[:, 'nova_coluna'] = ['a', 'b', 'c']
063) Como remover linhas específicas de um dataframe com base em seu índice?	df.drop(index = [0, 3, 6], inplace = True)
064) Como alterar a quantidade máxima de colunas que podem ser visualizadas de uma vez em um dataframe do pandas?	pd.options.display.max_columns = 200 <br><br> with pd.option_context("display.max_columns", 35): <br> display(df.head()) <br><br> pd.reset_option("display.max_columns") # Para resetar a configuração de apresentação de quantidade máxima de colunas
065) Como filtrar selecionar um dataframe considerando os x maiores valores de uma ou mais colunas específicas?	df.nlargest(n = 10, columns = ["coluna_1", "coluna_2"])
066) Como filtrar selecionar um dataframe considerando os x menores valores de uma ou mais colunas específicas?	df.nsmallest(n = 10, columns = ["coluna_1", "coluna_2"])
067) Qual a motivação em alterar o tipo de algumas colunas de um dataframe para categóricas não-ordenada e como fazer isso?	Redução no uso da memória e aumento na velocidade do processamento, visto que o pandas ao invés de tratar as linhas como texto trata com um número <br><br> df["coluna_1"] = df["coluna_1"].astype(dtype = "category")
068) Como verificar os tipos únicos de uma coluna categórica não-ordenada de um dataframe?	df["coluna_1"].cat.categories
069) Como verificar os tipos únicos dos códigos numéricos de uma coluna categórica não-ordenada de um dataframe?	df["coluna_1"].cat.codes.unique()
070) Quais são as funções de agregação do parâmetro pivot_table?	mean, sum, count, min, max, std, var, median, first, last, nunique, np.ptp (Calcula a amplitude, ou seja, o máximo menos o mínimo)
071) Explique o conceito de crosstab no dataframe do pandas?	pd.crosstab(index = [df["coluna_1"], df["coluna_2"]], columns = [df["coluna_3"]], normalize = "columns", margins = True, margins_name = "Total", normalize = "index") <br><br> É um método semelhante ao pivot_table, contudo sua finalidade está em realizar a contagem, principalmente de colunas cujo os elementos não são numéricos.
072) Qual a diferença entre os seguintes métodos do pandas pivot, pivot_table e crosstab?	pivot é utilizado para visualizar os dados originais de uma determinada coluna, considerando o agrupamento de outras colunas no índice e nas colunas, não pode haver duplicatas <br><br> pivot_table apresenta um comportamento semelhante ao pivot, com a diferença que ele pode receber valores duplicados, de modo que é aplicado alguma função de agregação, como a soma, média, contagem de todos os itens que estariam duplicados <br><br> crosstab busca focar na contagem de determinados grupos com base em agrupamentos de outras colunas em índices e colunas, funciona para colunas não numéricas.
073) Como colorir um dataframe?	pd.crosstab(index = df["coluna_1"], columns = df["coluna_2"]).style.background_gradient(cmap = "RdYlGn", axis = "columns", vmin = 0, vmax = 1) <br><br><br><br> def colorir_celulas(val): <br> color = 'red' if val > 20 else 'green' <br> return f'background-color: {color}' <br><br> df_styled = df.style.map(colorir_celulas)
074) Como criar uma coluna em um dataframe que é o resultado da soma acumulada de outra coluna?	df["coluna_acumulada"] = df["coluna"].cumsum()
075) Como calcular o valor de um determinado percentil para as colunas numéricas de um dataframe?	df.quantile(q = [0.1, 0.35], axis = 0, numeric_only=True)
076) Como aplicar uma função a todas as células de um dataframe?	df.map(func = lambda x: str(x), na_action = 'ignore')
077) Como alterar o formato dos números flutuantes de um dataframe e como resetar a configuração depois?	pd.options.display.float_format = "{:,.2f}".format <br><br> pd.reset_option("display.float_format")
078) Como alterar a largura das células de um dataframe?	pd.options.display.max_colwidth = 200 <br> pd.reset_option("display.max_colwidth") # Reseta para a configuração padrão <br><br> with pd.option_context("display.max_colwidth", 200): <br> display(df)
079) Como alterar a quantidade máxima de linhas apresentada em um dataframe?	pd.options.display.max_rows = 200 <br> pd.reset_option("display.max_rows") # Reseta para a configuração padrão <br><br> with pd.option_context("display.max_rows", 200): <br> display(df)
080) Qual o parâmetro do método do pandas que limita a quantidade de linhas que serão importadas de um dataframe independentemente de seu formato?	nrows = 100
081) Imagine que você possua uma base de dados muito pesada, de modo que seu computador é incapaz de criar o dataframe de uma única vez, como você faria para realizar as suas análises?	# No formato de iteração abaixo o pandas importa de 1000 em 1000 linhas do dataframe original e cria um dataframe chamado 'chunk' com essas mil linhas, então você deve aplicar sua análise com agrupamento, soma ou média das colunas e concantenando em um novo dataframe que armazenará os cálculos dessas 1000 linhas<br><br> for chunk in pd.read_csv(filepath_or_buffer = r"kaggle\arquivo.csv", chunksize = 1000):
082) Como juntar dois ou mais dataframes pelas linhas ou pelas colunas?	novo_df = pd.concat(objs = [df1, df2], axis = "index", ignore_index = True) <br><br> novo_df = pd.concat(objs = [df1, df2], axis = "columns", ignore_index = True)
083) Como alterar os nomes dos índices de um dataframe?	df.rename(index = {0: "nome_1", 1: "nome_2", 2: "nome_3", 3: "nome_4"}, inplace = True) <br> df.index = ["a", "b", "c"]
084) Como criar uma coluna categórica ordenada em um dataframe a partir de uma coluna numérica?	intervalo = [0, 29, 40, float("inf")] <br> rotulos = ["Adulto jovem", "Adulto médio", "Idoso"] <br> df["FaixaEtaria"] = pd.cut(x = df.Age, bins = intervalo, labels = rotulos)
085) Como criar vários histogramas de colunas numéricas de um dataframe de uma única vez?	df.select_dtypes(include = "number").hist(figsize = (20, 50), grid = False, bins = 15, layout = (13, 2));
086) Como criar histogramas considerando o agrupamento de duas ou mais colunas em relação a uma coluna específica de um dataframe?	df.hist(column = "Age", by = ["Gender", "Attrition"], grid = False, sharey = True, sharex = True, layout = (2, 2), figsize = (14, 8), legend = True);
087) Como criar um gráfico boxplot através de um dataframe com agrupamentos e outros tipos de configurações?	df.boxplot(column = "Age", vert = False, grid = False, showmeans = True); <br><br> df.Age.plot(kind = "box", showmeans = True, title = "Gráfico BoxPlot", xlabel = "Idade", ylabel = "Idade", yticks = np.arange(15, 65.1, 5)); <br><br> df.plot(kind = "box", column = "Age", by = ["Gender", "Attrition"], showmeans = True, vert = False)
088) Como realizar o describe de uma coluna específica de um dataframe considerando o agrupamento de duas ou mais outras colunas?	df.groupby(by = ["Gender", "Attrition"])["Age"].describe().round(decimals = 1)
089) Como criar gráficos boxplot para uma coluna específica, considerando a filtragem em relação à uma coluna específica e o agrupamento de uma ou mais colunas?	for job in df.JobRole.unique(): df[df.JobRole == job].plot(kind = "box", column = "MonthlyIncome", by = ["JobLevel", "Gender"], showmeans = True, title = job)
090) Qual seria a forma mais eficiente para substituir os tipos de uma determinada coluna de um dataframe, por exemplo, substituir números inteiros por nomes específicos ou nomes por outros nomes?	mapa_tipo = {"Presencial": 1, "Hibrído": 2, "Remoto": 3} <br> for mapa in mapa_tipo.keys(): df.loc[df.tipo == mapa, "novo_tipo"] = mapa_tipo[mapa] <br><br> É interessante você criar uma nova coluna para evitar os avisos do pandas, porque se você tem uma coluna de inteiros e quer substituir por string, o pandas não aceita diferentes tipos na mesma coluna.
091) Como usar o replace no pandas?	df["tipo"].replace(to_replace = {"Hibrído": "hib", "Remoto": "rem", "Presencial": "pre"})
092) Considerando uma coluna de datas de um dataframe, como obter uma series que contém, os segundos, minutos, horas, dia, mês, ano, número do dia da semana, nome do dia da semana, nome do mês, dia do ano, trimestre?	df["coluna_data"].dt.second <br> df["coluna_data"].dt.minute <br> df["coluna_data"].dt.hour <br> df["coluna_data"].dt.day <br> df["coluna_data"].dt.month <br> df["coluna_data"].dt.year <br> df["coluna_data"].dt.weekday ou df["coluna_data"].dt.day_of_week # Segunda-feira é 0 <br> df["coluna_data"].dt.day_name() <br> df["coluna_data"].dt.month_name() <br> df["coluna_data"].dt.dayofyear <br> df["coluna_data"].dt.quarter
093) Considerando uma coluna de datas de um dataframe, como saber a quantidade de dias totais daquele determinado mês, se é início e fim de mês e se é início ou fim de ano?	df["data"].dt.days_in_month <br> df["data"].dt.is_month_start <br> df["data"].dt.is_month_end <br> df["data"].dt.is_year_start <br> df["data"].dt.is_year_end
094) Em um dataframe que possui datas, como filtrar as linhas que contenham dias úteis e finais de semana?	df[~df.data.dt.day_name().isin(["Saturaday", "Sunday"])] <br> df[df.data.dt.day_name().isin(["Saturaday", "Sunday"])]
095) Considerando um dataframe com datas, como filtrar as linhas que estão em uma faixa de até 3 meses em relação ao dia atual?	df[(df.data >= pd.to_datetime("today") - pd.DateOffset(months = 3)) & (df.data <= pd.to_datetime("today"))]
096) Como obter apenas o valor de um tipo series?	ser[2] <br> ser.iloc[2] <br> ser.loc[2]
097) Em uma função, como usar o type hint para um parâmetro de entrada ou saída do tipo pandas?	from typing import Union <br> Union[pd.DataFrame, pd.Series] # Para versões antes do python 3.10 <br><br> pd.DataFrame | pd.Series # Para versões mais recentes (Python 3.10 ou superior)